â€<!DOCTYPE html>
â€<html lang="en">
â€<head>
â€Â Â Â  <meta charset="UTF-8">
â€Â Â Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
â€Â Â Â  <title>Last Chain | Ultimate Web3</title>
â€Â Â Â  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
â€Â Â Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
â€Â Â Â  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
â€Â Â Â  <style>
â€Â Â Â Â Â Â Â  :root { --primary: #00ff00; --bg: #000; --card: #0a0a0a; --blur-bg: rgba(0,0,0,0.6); }
â€Â Â Â Â Â Â Â  * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
â€Â Â Â Â Â Â Â  body { background: var(--bg); color: #fff; overflow-x: hidden; }
â€Â Â Â Â Â Â Â  .hidden { display: none !important; }
â€
â€Â Â Â Â Â Â Â  /* Sidebar & Overlay */
â€Â Â Â Â Â Â Â  #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--blur-bg); backdrop-filter: blur(8px); display: none; z-index: 1050; opacity: 0; transition: 0.3s; }
â€Â Â Â Â Â Â Â  #overlay.active { display: block; opacity: 1; }
â€Â Â Â Â Â Â Â  .sidebar { position: fixed; left: -280px; width: 280px; height: 100vh; background: #050505; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); z-index: 1100; border-right: 1px solid #1a1a1a; display: flex; flex-direction: column; }
â€Â Â Â Â Â Â Â  .sidebar.active { left: 0; box-shadow: 10px 0 50px rgba(0,255,0,0.1); }
â€Â Â Â Â Â Â Â  .menu-item { padding: 20px 30px; cursor: pointer; color: #666; font-weight: 600; transition: 0.3s; }
â€Â Â Â Â Â Â Â  .menu-item:hover, .active-tab { color: var(--primary); background: rgba(0,255,0,0.05); }
â€Â Â Â Â Â Â Â  .logout-btn { margin-top: auto; padding: 25px; color: #ff4444; border-top: 1px solid #111; cursor: pointer; font-size: 14px; }
â€
â€Â Â Â Â Â Â Â  /* Header */
â€Â Â Â Â Â Â Â  header { display: flex; align-items: center; padding: 15px 20px; border-bottom: 1px solid #1a1a1a; background: rgba(0,0,0,0.9); position: sticky; top: 0; z-index: 1000; }
â€Â Â Â Â Â Â Â  #page-title { font-family: 'Orbitron'; font-size: 14px; margin-left: 20px; color: #888; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  .header-right { margin-left: auto; display: flex; align-items: center; gap: 10px; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  /* Point + Wallet Group */
â€Â Â Â Â Â Â Â  .wallet-box { display: flex; align-items: center; background: #111; border: 1px solid #222; border-radius: 12px; padding: 4px; gap: 8px; position: relative; }
â€Â Â Â Â Â Â Â  .points-display { padding: 0 10px; font-family: 'Orbitron'; font-size: 12px; color: var(--primary); font-weight: bold; border-right: 1px solid #222; }
â€Â Â Â Â Â Â Â  .wallet-btn { background: #fff; color: #000; padding: 6px 12px; border-radius: 8px; font-weight: bold; border: none; cursor: pointer; font-size: 11px; }
â€Â Â Â Â Â Â Â  .wallet-btn.connected { background: transparent; color: #fff; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  .disconnect-dropdown { position: absolute; top: 45px; right: 0; background: #111; border: 1px solid #222; border-radius: 10px; width: 150px; display: none; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
â€Â Â Â Â Â Â Â  .disconnect-dropdown button { width: 100%; padding: 12px; background: none; border: none; color: #ff4444; cursor: pointer; font-weight: bold; font-size: 12px; }
â€
â€Â Â Â Â Â Â Â  /* Dashboard UI - Theme & Shining Boxes */
â€Â Â Â Â Â Â Â  .main-content { padding: 20px; max-width: 1000px; margin: 0 auto; transition: 0.3s; }
â€Â Â Â Â Â Â Â  .stats-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px; }
â€Â Â Â Â Â Â Â  .stat-card { background: var(--card); border: 1px solid #1a1a1a; padding: 20px; border-radius: 15px; text-align: center; position: relative; overflow: hidden; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  /* Original Shining Effect */
â€Â Â Â Â Â Â Â  .stat-card::after { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.03), transparent); transform: rotate(45deg); animation: shine 4s infinite; }
â€Â Â Â Â Â Â Â  @keyframes shine { 0% { left: -100%; } 100% { left: 100%; } }
â€
â€Â Â Â Â Â Â Â  .stat-card h2 { font-family: 'Orbitron'; font-size: 20px; color: var(--primary); margin-top: 5px; }
â€Â Â Â Â Â Â Â  .stat-card p { font-size: 10px; color: #555; text-transform: uppercase; letter-spacing: 1px; }
â€
â€Â Â Â Â Â Â Â  .progress-box { background: var(--card); padding: 20px; border-radius: 15px; border: 1px solid #1a1a1a; margin-bottom: 25px; }
â€Â Â Â Â Â Â Â  .bar-bg { background: #111; height: 10px; border-radius: 10px; margin-top: 10px; overflow: hidden; }
â€Â Â Â Â Â Â Â  .bar-fill { height: 100%; background: var(--primary); width: 0%; box-shadow: 0 0 15px var(--primary); transition: 1.5s ease; }
â€
â€Â Â Â Â Â Â Â  .bottom-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
â€Â Â Â Â Â Â Â  .tall-box { background: var(--card); border: 1px solid #1a1a1a; border-radius: 15px; padding: 20px; min-height: 400px; }
â€Â Â Â Â Â Â Â  .tall-box h4 { font-family: 'Orbitron'; font-size: 12px; color: #fff; margin-bottom: 20px; border-bottom: 1px solid #1a1a1a; padding-bottom: 10px; }
â€
â€Â Â Â Â Â Â Â  .mission-card { background: var(--card); border: 1px solid #1a1a1a; padding: 25px; border-radius: 20px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
â€Â Â Â Â Â Â Â  .btn-claim { background: var(--primary); color: #000; padding: 12px 25px; border-radius: 10px; font-weight: bold; border: none; cursor: pointer; }
â€Â Â Â Â Â Â Â  .btn-claim:disabled { background: #222; color: #555; cursor: not-allowed; }
â€
â€Â Â Â Â Â Â Â  @media (max-width: 768px) { .stats-row, .bottom-grid { grid-template-columns: 1fr; } }
â€Â Â Â  </style>
â€</head>
â€<body>
â€
â€Â Â Â  <div id="overlay" onclick="toggleSidebar()"></div>
â€
â€Â Â Â  <div id="sidebar" class="sidebar">
â€Â Â Â Â Â Â Â  <div style="padding:40px 30px; font-family:'Orbitron'; font-weight:bold; font-size:22px; color:var(--primary);">LAST CHAIN</div>
â€Â Â Â Â Â Â Â  <div class="menu-item active-tab" onclick="switchTab('dashboard-view', 'DASHBOARD')">ğŸ  Dashboard</div>
â€Â Â Â Â Â Â Â  <div class="menu-item" onclick="switchTab('tasks-view', 'MISSIONS')">ğŸ¯ Missions</div>
â€Â Â Â Â Â Â Â  <div class="logout-btn" onclick="logout()">ğŸšª Logout User</div>
â€Â Â Â  </div>
â€
â€Â Â Â  <div id="app-container" class="hidden">
â€Â Â Â Â Â Â Â  <header>
â€Â Â Â Â Â Â Â Â Â Â Â  <div onclick="toggleSidebar()" style="cursor:pointer; font-size:24px;">â˜°</div>
â€Â Â Â Â Â Â Â Â Â Â Â  <div id="page-title">DASHBOARD</div>
â€Â Â Â Â Â Â Â Â Â Â Â  <div class="header-right">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="wallet-box">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="points-display"><span id="header-pts">0</span> LAST</div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="wallet-container">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <button id="btn-wallet" class="wallet-btn" onclick="handleWalletClick()">Connect Wallet</button>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div id="wallet-menu" class="disconnect-dropdown">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <button onclick="disconnectWallet()">Disconnect</button>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  </header>
â€
â€Â Â Â Â Â Â Â  <main class="main-content">
â€Â Â Â Â Â Â Â Â Â Â Â  <div id="dashboard-view" class="tab-content">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="stats-row">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="stat-card"><p>Streak</p><h2 id="s-val">0 Days</h2></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="stat-card"><p>Today Points</p><h2 id="t-pts">0</h2></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="stat-card"><p>Level</p><h2>BRONZE</h2></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="progress-box">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div style="display:flex; justify-content:space-between; font-size:11px; color:#555;">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span>Level Progress</span><span id="p-txt">0/5000</span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="bar-bg"><div id="bar" class="bar-fill"></div></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="bottom-grid">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="tall-box"><h4>TASK HISTORY</h4><div id="history-list"></div></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="tall-box">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <h4 style="margin:0; border:0;">LABORHOOD</h4>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span id="my-rank" style="color:var(--primary); font-size:11px; font-weight:bold;">#--</span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div id="leaderboard"></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  </div>
â€
â€Â Â Â Â Â Â Â Â Â Â Â  <div id="tasks-view" class="tab-content hidden">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="mission-card">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div><h3>Daily Check-in</h3><p style="color:#555; font-size:12px;">Claim +100 LAST tokens</p></div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <button id="c-btn" class="btn-claim" onclick="claimDaily()">Claim</button>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  </main>
â€Â Â Â  </div>
â€
â€Â Â Â  <div id="auth-view" style="height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center;">
â€Â Â Â Â Â Â Â  <h1 style="font-family:'Orbitron'; color:var(--primary); letter-spacing:10px;">LAST CHAIN</h1>
â€Â Â Â Â Â Â Â  <button onclick="login()" class="btn-claim" style="margin-top:30px; padding:15px 40px; border-radius:30px;">Login with Google</button>
â€Â Â Â  </div>
â€
â€Â Â Â  <script>
â€Â Â Â Â Â Â Â  const S_URL = "https://pkqpcxqwhzuuooovqkvc.supabase.co";
â€Â Â Â Â Â Â Â  const S_KEY = "sb_publishable_4nApSgj0pwrInFkUYx14_A_sM2AixLY";
â€Â Â Â Â Â Â Â  const _supabase = supabase.createClient(S_URL, S_KEY);
â€Â Â Â Â Â Â Â  let user = null;
â€
â€Â Â Â Â Â Â Â  async function login() { await _supabase.auth.signInWithOAuth({ provider: 'google' }); }
â€
â€Â Â Â Â Â Â Â  async function init() {
â€Â Â Â Â Â Â Â Â Â Â Â  const { data: { session } } = await _supabase.auth.getSession();
â€Â Â Â Â Â Â Â Â Â Â Â  if (session) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  await fetchUser(session.user.id);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  fetchHistory();
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  fetchLeaderboard();
â€Â Â Â Â Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function fetchUser(id) {
â€Â Â Â Â Â Â Â Â Â Â Â  let { data: profile } = await _supabase.from('profiles').select('*').eq('id', id).single();
â€Â Â Â Â Â Â Â Â Â Â Â  if (!profile) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const { data } = await _supabase.from('profiles').insert([{ id, balance: 0 }]).select().single();
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  profile = data;
â€Â Â Â Â Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â Â Â Â Â  user = profile;
â€Â Â Â Â Â Â Â Â Â Â Â  updateUI();
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  function updateUI() {
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('auth-view').classList.add('hidden');
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('app-container').classList.remove('hidden');
â€
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('header-pts').innerText = user.balance;
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('s-val').innerText = (user.streak || 0) + " Days";
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('t-pts').innerText = (user.today_points || 0);
â€
â€Â Â Â Â Â Â Â Â Â Â Â  const per = Math.min((user.balance / 5000) * 100, 100);
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('bar').style.width = per + "%";
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('p-txt').innerText = `${user.balance}/5000`;
â€
â€Â Â Â Â Â Â Â Â Â Â Â  const wBtn = document.getElementById('btn-wallet');
â€Â Â Â Â Â Â Â Â Â Â Â  if (user.wallet_address) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  wBtn.innerText = user.wallet_address.substring(0,6) + "..." + user.wallet_address.slice(-4);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  wBtn.classList.add('connected');
â€Â Â Â Â Â Â Â Â Â Â Â  } else {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  wBtn.innerText = "Connect Wallet";
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  wBtn.classList.remove('connected');
â€Â Â Â Â Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â Â Â Â Â  if (user.last_checkin) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const isLocked = (Date.now() - new Date(user.last_checkin).getTime()) < 86400000;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('c-btn').disabled = isLocked;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  if(isLocked) document.getElementById('c-btn').innerText = "Locked";
â€Â Â Â Â Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  function handleWalletClick() {
â€Â Â Â Â Â Â Â Â Â Â Â  if (user.wallet_address) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const menu = document.getElementById('wallet-menu');
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
â€Â Â Â Â Â Â Â Â Â Â Â  } else { connectWallet(); }
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function connectWallet() {
â€Â Â Â Â Â Â Â Â Â Â Â  if (!window.ethereum) return alert("Install MetaMask!");
â€Â Â Â Â Â Â Â Â Â Â Â  try {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // Fix: Force MetaMask to show account selection even after disconnect
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  await window.ethereum.request({ method: 'wallet_requestPermissions', params: [{ eth_accounts: {} }] });
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const provider = new ethers.providers.Web3Provider(window.ethereum);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const accounts = await provider.send("eth_requestAccounts", []);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const wallet = accounts[0];
â€
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // Added: Confirmation Message Pop-up
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const signer = provider.getSigner();
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const msg = "Confirm connection to Last Chain Ecosystem";
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  await signer.signMessage(msg);
â€
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  await _supabase.from('profiles').update({ wallet_address: wallet }).eq('id', user.id);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  user.wallet_address = wallet;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  updateUI();
â€Â Â Â Â Â Â Â Â Â Â Â  } catch (e) { console.log("User cancelled"); }
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function disconnectWallet() {
â€Â Â Â Â Â Â Â Â Â Â Â  await _supabase.from('profiles').update({ wallet_address: null }).eq('id', user.id);
â€Â Â Â Â Â Â Â Â Â Â Â  user.wallet_address = null;
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('wallet-menu').style.display = 'none';
â€Â Â Â Â Â Â Â Â Â Â Â  updateUI();
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  function toggleSidebar() {
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('sidebar').classList.toggle('active');
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('overlay').classList.toggle('active');
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  function switchTab(id, title) {
â€Â Â Â Â Â Â Â Â Â Â Â  document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById(id).classList.remove('hidden');
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('page-title').innerText = title;
â€Â Â Â Â Â Â Â Â Â Â Â  document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active-tab'));
â€Â Â Â Â Â Â Â Â Â Â Â  toggleSidebar();
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function claimDaily() {
â€Â Â Â Â Â Â Â Â Â Â Â  const { error } = await _supabase.from('profiles').update({ 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  balance: user.balance + 100, 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  streak: (user.streak || 0) + 1,
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  last_checkin: new Date() 
â€Â Â Â Â Â Â Â Â Â Â Â  }).eq('id', user.id);
â€Â Â Â Â Â Â Â Â Â Â Â  if(!error) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  await _supabase.from('task_history').insert([{ user_id: user.id, task_name: 'Daily Check-in', points: 100 }]);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  fetchUser(user.id);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  fetchHistory();
â€Â Â Â Â Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function fetchHistory() {
â€Â Â Â Â Â Â Â Â Â Â Â  const { data } = await _supabase.from('task_history').select('*').eq('user_id', user.id).order('completed_at', { ascending: false });
â€Â Â Â Â Â Â Â Â Â Â Â  const list = document.getElementById('history-list');
â€Â Â Â Â Â Â Â Â Â Â Â  list.innerHTML = data?.length ? data.map(h => `
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div style="display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #111; font-size:12px;">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span><b>${h.task_name}</b><br><small style="color:#444">${new Date(h.completed_at).toLocaleString()}</small></span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span style="color:var(--primary)">+${h.points}</span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  `).join('') : 'No tasks yet';
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function fetchLeaderboard() {
â€Â Â Â Â Â Â Â Â Â Â Â  const { data } = await _supabase.from('profiles').select('id, balance').order('balance', { ascending: false }).limit(5);
â€Â Â Â Â Â Â Â Â Â Â Â  const list = document.getElementById('leaderboard');
â€Â Â Â Â Â Â Â Â Â Â Â  list.innerHTML = data.map((u, i) => `
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div style="padding:10px; background:#080808; margin-bottom:8px; border-radius:8px; display:flex; justify-content:space-between; font-size:11px; ${u.id === user.id ? 'border:1px solid var(--primary)' : ''}">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span>#${i + 1} User...${u.id.slice(-4)}</span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span style="color:var(--primary)">${u.balance}</span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  `).join('');
â€Â Â Â Â Â Â Â Â Â Â Â  const { count } = await _supabase.from('profiles').select('*', { count: 'exact', head: true }).gt('balance', user.balance);
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('my-rank').innerText = `#${(count || 0) + 1}`;
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  async function logout() { await _supabase.auth.signOut(); window.location.reload(); }
â€Â Â Â Â Â Â Â  window.onload = init;
â€Â Â Â  </script>
â€</body>
â€</html>
â€
